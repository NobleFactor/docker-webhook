.\" SPDX-FileCopyrightText: 2016-2025 Noble Factor
.\" SPDX-License-Identifier: MIT
.TH Test-WebhookExecutorIntegration 1 "November 2025" "docker-webhook" "User Commands"
.SH NAME
Test-WebhookExecutorIntegration \- black-box API test for webhook-executor responses via webhook service
.SH SYNOPSIS
.B Test-WebhookExecutorIntegration
\fI--container\fR \fICONTAINER\fR \fI--destination\fR \fIDESTINATION\fR \fI--location\fR \fILOCATION\fR \fI--command\fR \fICOMMANDS\fR [\fI--help\fR]
.SH DESCRIPTION
Test-WebhookExecutorIntegration is a black-box test script that validates the API responses
from webhook-executor hooks in a running webhook deployment via the webhook service using hooks.json routing. It sources Key Vault-related environment variables from the per-location hooks environment and will obtain a JWT via the bundled bin/New-WebhookExecutorToken when needed. The test performs HTTP GET requests to the webhook endpoint inside the container to exercise the hooks and validates the JSON responses.

The script is designed for testing webhook-executor functionality without inspecting
container internals, focusing solely on API behavior. It measures test execution time
and reports pass/fail counts for each tested command.

.IP "-" 2
Sends a GET request to the container webhook endpoint (webhook_url) with query parameters including the destination and command.
.IP "-" 2
Validates the JSON response contains required fields: exit_code, reason, error, stdout, stderr
.IP "-" 2
Reports success or failure with detailed output

The test requires a running webhook instance with webhook-executor configured hooks.
See the API Reference section in README.md for complete response schema documentation.
.SH OPTIONS
.TP
.B -h,--help
Display usage information and exit.
.TP
.B --command COMMANDS
Required. A semicolon-separated list of commands to execute and test (for example: "echo 'hello world'; ls").
The script will split the provided string on semicolons and issue one request per command, preserving embedded
spaces and quoting.
.TP
.B --container CONTAINER
Required. The container name where the webhook service is running (the script uses this to determine the service IP).
.TP
.B --destination DESTINATION
Required. The SSH destination used by the webhook route (e.g., user@host or ssh://user@host:port).
.TP
.B --location LOCATION
Required. The location identifier used to discover the volume-based hooks environment (volumes/LOCATION/hooks.env).
.SH EXIT STATUS
The script exits with code 0 if all tests pass, or 1 if any test fails. Individual command
failures are reported but do not immediately terminate the script; all specified commands
are tested.
.SH EXAMPLES
Test a single command against a running webhook in a container:
.IP
Test-WebhookExecutorIntegration --container webhook-us-wa-dev --destination ssh://user@target-host:2222 --location us-wa --command "uptime"

Test multiple commands (semicolon-separated):
.IP
Test-WebhookExecutorIntegration --container webhook-us-wa-dev --destination user@target-host --location us-wa --command "echo 'hello world'; date; whoami"

Test with a remote target and additional commands:
.IP
Test-WebhookExecutorIntegration --container webhook-us-wa-dev --destination production-server --location us-wa --command "systemctl status nginx"
.SH SEE ALSO
.BR README.md (API Reference),
.BR docker-webhook (1),
.BR webhook-executor (1),
.BR Test-WebhookExecutorStandalone (1)
.SH AUTHOR
David Noble
.SH COPYRIGHT
Copyright \(co 2016-2025 Noble Factor.
.br
Licensed under the MIT License.</content>
<parameter name="filePath">/Users/david-noble/Workspace/NobleFactor/docker-webhook/share/man/man1/Test-DockerWebhookDeployment.1