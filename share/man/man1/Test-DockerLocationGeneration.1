.\" SPDX-FileCopyrightText: 2016-2025 Noble Factor
.\" SPDX-License-Identifier: MIT
.TH Test-DockerLocationGeneration 1 "November 2025" "docker-webhook" "User Commands"
.SH NAME
Test-DockerLocationGeneration \- automated test for Docker location-based artifact and certificate generation
.SH SYNOPSIS
Test-DockerLocationGeneration [ --test-location <location> ] [ --help ]
.SH DESCRIPTION
This script verifies that generated Docker Compose and certificate artifacts for a given location match baseline reference files and certificates.
.PP
Workflow:
.IP "1." 3
Removes any previously generated artifacts, Compose YAML, and env files for the test location.
.IP "2." 3
Generates new artifacts using bin/New-DockerLocation and the specified env file.
.IP "3." 3
Runs make New-DockerCertificates for the location.
.IP "4." 3
Checks for existence of generated Compose YAML, env, and certificate files.
.IP "5." 3
Compares generated Compose YAML and env files to baseline using diff.
.IP "6." 3
Compares certificate-request.conf to baseline using diff.
.IP "7." 3
Performs field-by-field comparison for self-signed.csr and public-key.pem using openssl and custom extract_cert_info.
.IP "8." 3
If all comparisons pass, removes generated artifacts; if any fail, leaves them for inspection.
.PP
Generated files:
.br
	docker-<location>.services.yaml
.br
	docker-<location>.env
.br
	secrets/certificates/<location>/certificate-request.conf
.br
	secrets/certificates/<location>/self-signed.csr
.br
	secrets/certificates/<location>/public-key.pem
.br
Baseline files:
.br
	test/baseline/docker-<location>.yaml
.br
	test/baseline/docker-<location>.env
.br
	test/baseline/secrets/certificates/<location>/certificate-request.conf
.br
	test/baseline/secrets/certificates/<location>/self-signed.csr
.br
	test/baseline/secrets/certificates/<location>/public-key.pem
.br
.SH OPTIONS
.TP
.B --test-location <location>
Location name (e.g., 'fake-wa', 'us-wa').
.TP
.B --help
Show usage information and exit.
.SH AUTHOR
David Noble
.SH COPYRIGHT
Copyright \(co 2016-2025 Noble Factor.
.br
Licensed under the MIT License.
