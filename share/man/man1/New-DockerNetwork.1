########################################################################################################################
# SPDX-FileCopyrightText: 2016-2025 Noble Factor
# SPDX-License-Identifier: MIT
########################################################################################################################
.TH New-DockerNetwork 1 "November 2025" "docker-webhook" "User Commands"
.SH NAME
New-DockerNetwork \- create a Docker network using Noble Factor conventions
.SH SYNOPSIS
New-DockerNetwork [OPTIONS] SERVICE-NAME
.SH DESCRIPTION
Create a Docker network using Noble Factor conventions. The network is named as 
\fISERVICE-NAME\fB:\fIDEVICE-NAME\fR. If you do not specify a device name, the 
default device name is used. On Linux, the default is obtained from the operating 
system using \fBip route show default\fR. On macOS, the default is obtained from the 
operating system using \fBscutil --dns\fR.
.PP
Note that IPv6 and macvlan networks can only be created on Linux hosts.
.SH ARGUMENTS
.TP
.B SERVICE-NAME
A docker service name.
.TP
.B -h, --help
Print this text and exit.
.TP
.B -d, --device DEVICE-NAME
Parent network device name. Default: On Linux, the primary network interface as reported by 'ip route show default'. On macOS, the primary network interface as returned by 'scutil --dns'.
.TP
.B -D, --driver DRIVER-NAME
Driver type. Default: macvlan.
.TP
.B --ip-range IP-RANGE
Allocate container IPv4 addresses from a CIDR block. Example: 192.168.8/29 allocates a block of 5 IP addresses in the range [9,14]. 'ipcalc' is a convenient tool for computing CIDR block values. By default, docker allocates container addresses from the entire IPv4 subnet. Ensure that the CIDR block you specify is unused by, for example, your local DHCP server.
.SH BEHAVIOR
The script automatically:
.IP \(bu 2
Detects the operating system (Darwin/macOS or GNU/Linux)
.IP \(bu 2
Determines the default network interface if not specified
.IP \(bu 2
Calculates IPv4 subnet and gateway information
.IP \(bu 2
On GNU/Linux: Also configures IPv6 networking
.IP \(bu 2
Removes any existing network with the same name
.IP \(bu 2
Creates the new network with appropriate settings
.IP \(bu 2
Displays the network configuration upon completion
.SH EXAMPLES
.TP
Create a network for a web service using default settings:
.B New-DockerNetwork web-service
.TP
Create a network using a specific device on Linux:
.B New-DockerNetwork --device=wlan0 api-service
.TP
Create a network with bridge driver:
.B New-DockerNetwork --driver=bridge --device=eth1 database
.SH PLATFORM DIFFERENCES
.TP
.B macOS (Darwin)
\(bu Uses "scutil --dns" to determine default interface
.br
\(bu IPv4-only network configuration
.br
\(bu Uses ipcalc and ifconfig for network calculations
.TP
.B GNU/Linux
\(bu Uses \fBip route show default\fR to determine default interface
.br
\(bu Supports both IPv4 and IPv6 networking
.br
\(bu Uses nmcli for network information gathering
.SH EXIT STATUS
.TP
0
.I \fBdocker\fR, \fBsudo\fR, \fBgetopt\fR, \fBuname\fR
Success
.TP
.I \fBscutil\fR, \fBipcalc\fR, \fBifconfig\fR, \fBtraceroute\fR
1
Error (invalid arguments, unsupported OS, network creation failure, etc.)
.I \fBnmcli\fR, \fBipcalc\fR
.SH DEPENDENCIES
.TP
.B Required commands:
docker, sudo, getopt, uname
.TP
.B macOS specific:
scutil, ipcalc, ifconfig, traceroute
.TP
.B GNU/Linux specific:
nmcli, ipcalc
.SH FILES
.TP
.I Declare-BashScript
Sourced utility script for argument parsing and error handling
.SH AUTHOR
Noble Factor
.SH SEE ALSO
.BR docker-network-create (1),
.BR docker-network (1),
.BR docker (1),
.BR ip (8)
.BR nmcli (1),
.BR scutil (8),
.BR ipcalc (1)
